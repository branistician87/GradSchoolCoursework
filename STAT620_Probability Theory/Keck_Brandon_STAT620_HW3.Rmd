---
title: "HW3"
author: "Brandon Keck"
output:
  html_document: default
  pdf_document: default
date: "2024-09-13"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 2.2-1
### (a) f(x) = x/c, x = 1, 2, 3, 4.

$E(X) = \sum_{x =1} ^{4} x \cdot f(x)$

From previous problems we found the value of c = 10.

E(X)=
```{r}
(1 * 1/10) + (2 * 2/10) + (3 * 3/10) + (4 * 4/10)
```
So, E(X) = $\boxed{3}$


### (b) f(x) = c * x, x = 1, 2, 3,..., 10. 

$E(X) = \sum_{x =1} ^{10} x \cdot f(x)$

From previous problems we found the value of c = 1/55

The values of x are 1,2,3,4,5,6,7,8,9,10.
To obtain $E(X) = \sum_{x =1} ^{10} x \cdot f(x)$ we can substitute 1,2,3,4,5,6,7,8,9,10 for x

E(X)=
```{r}
(1 * 1/55) + (2 * 2/55) + (3 * 3/55) + (4 * 4/55) + (5 * 5/55) + (6 * 6/55) + (7 * 7/55) + (8 * 8/55) + (9 * 9/55) + (10* 10/55)
```
 So, E(X) = $\boxed{7}$


### (c) f(x) = c * (1/4)^x, x = 1, 2, 3,.... 

$E(X) = \sum_{x =1} ^{\infty} x \cdot f(x)$

From previous problems we found the value of c = 3

$E(X) = \sum_{x=1}^{\infty} 3x \left(\frac{1}{4}\right)^x$

$E(X) = 3\cdot  \sum_{x=1}^{\infty} x \left(\frac{1}{4}\right)^x$

This is a geometric series with r / (1-r)^2

let r = 1/4

(1/4) / (1 - 1/4)^2

= (1/4) / (3/4)^2

= (1/4) / 9/16

= 4/9

E(X) =
```{r}
3 * (4/9)
```
So, E(X) = $\boxed{4/3}$



### (d) f(x) = c * (x + 1)^2, x = 0, 1, 2, 3. 

$E(X) = \sum_{} ^{} x \cdot f(x)$

From previous problems we found c = 1/30

All we have to do is plug in values of x into the equation for E(X)

```{r}
(0 * 1/30) + (1 * 4/30) + (2 * 9/30) + (3 * 16/30)
```

So, E(X) = $\boxed{2.333333}$

### (e) f(x) = x/c, x = 1, 2, 3,..., n. 

$E(X) = \sum_{x=1} ^{n} x \cdot f(x)$

From previous problems we found c = n(n+1)/2

We simply substitute 1,2,3,....,n for x and x/c in for P(X) in E(X)

$E(X) = \sum_{x=1} ^{n} x$ * 2x/n(n+1)^x
=2/n(n+1) * $E(X) = \sum_{x=1} ^{n} x^2$

2/n(n=1) * n(n+1)(2n+1)/6

So, E(X) = $\boxed{2n+1/3}$

### (f) f(x) =  c / (x + 1)(x + 2), x = 0, 1, 2, 3,.... 

$E(X) = \sum_{x =0} ^{\infty} x \cdot f(x)$

From previous problems we found c = 1

x values are 1,2,3,....

We can substitute 0,1,2,3,.... for x to obtain the E(X).

$E(X) = \sum_{x=1}^{\infty} x \left( \frac{1}{(x+1)(x+2)} \right)$

However as we plug in our x values of 0,1,2,3,...${\infty}$

We can observe that the limit does not exist as the sum diverges towards infinity.

## 2.2-6
Let the pmf of X be defined by f(x) = 6/(π^2x^2),  x = 1, 2, 3,.... Show that E(X) does not exist in this case. 

$E(X) = \sum_{} ^{} x \cdot P(x)$

The pmf is f(x) = 6/(π^2x^2)

The values of x are 1,2,3,...${\infty}$

$E(X) = \sum_{x=1} ^{\infty} x \cdot ( \frac{6}{pi^2x^2})$

$( \frac{6}{pi^2})\cdot \sum_{x=1} ^{\infty} x \cdot (\frac{x}{x^2})$

We can pull out the $( \frac{6}{pi^2})$ since this is a constant


$( \frac{6}{pi^2})\cdot \sum_{x=1} ^{\infty}(\frac{1}{x})$



$\sum_{x=1} ^{\infty}(\frac{1}{x})$

Plugging in values of x results in infinity

= $\sum_{x=1} ^{\infty} (\frac{1}{1} +\frac{1}{2} + \frac{1}{3}+...)$

$=\infty$

Therefore, E(X) $\boxed{diverges and does not exist}$

## 2.2-11
### (a)
USA: Roulette table consists of 18 red, 18 black and two green slots.
For Probability of a success let P(X=1) = 18/38.
That means the Probability of failure P(X=-1) = 18/38 + 2/38 = 20/38 for both the black and green slots respectively. In order to obtain the E(X) we can follow the formula where the summation of x * f(x). To calculate the probability in question we have E(X) = (win outcome * P(win) + (loss outcome * P(loss)).
So E(X) = 1 * 18/38 + (-1) * 20/38

```{r}
 1 * 18/38 + (-1) * 20/38
```

So, E(X) = $\boxed{-0.05263158}$

        
### (b)
French: Roulette table consists of 18 red, 18 black and one green slots.
For a probability of a success let P(X = 1) = 18/37.
That means the Probability of failure P(x = -1) = 18/37 + 1/37 = 19/37 for both the black and green slots respectively. In order to obtain the E(x) we can follow the formula where the summation of x * f(x). To calculuate the probability in question we have E(X) = (win outcome * P(win) + (loss outcome * P(loss)).
So E(X) = 1* 18/37 + (-1) * 19/37
        
```{r}
1* 18/37 + (-1) * 19/37
```

So, E(X) = $\boxed{ -0.02702703}$

## 2.2-12
Suppose that a school has 20 classes: 16 with 25  students in each, three with 100 students in each, and one  with 300 students, for a total of 1000 students. 

### (a) What is the average class size? 
Let X be a random variable that represents class size.
E(X) = 1000/20

```{r}
1000/20
```
So, E(X) = $\boxed{50}$


### (b)

Let  the random variable X equal the size of the class. To get the p.m.f for  
x:

| x | 25 | 100 | 300 |
|:-------: |:-------------:|:--------------|:----------------|
|: Probs | $\frac{16}{20}$ | $\frac{3}{20}$ | $\frac{1}{20}$ |

# (c)
(c) Find E(X), the expected value of X. Does this answer surprise you? 

E(X) = 25 * 2/5 + 100 * 3/10 + 300 * 3/10

```{r}
x <- c(25, 100, 300)
y <- c(16/20, 3/20, 1/20)
sum(x*y)
```
E(X) = $\boxed{50}$


The expected value of x is the mean. We had calculated this earlier in part (a). This doesn't surprise me that they are the same we just calculated it a different way.



## 2.3-2
For each of the following distributions, find  μ = E(X), E[X(X −1)], and σ2 = E[X(X −1)]+E(X)−  μ2: 

### (a) f(x) =  3! / x!(3 − x)! *(1/4)^x * (3/4)^ 3-x

```{r}
x <- c(0, 1, 2, 3)
y <- c(factorial(3) / (factorial(x) * factorial(3-x))) * ((1/4)^x) * ((3/4)^(3-x))

sum(x*y)
```

So, E(X) = $\boxed{0.75}$

```{r}
sum(x^2 * y)
```

So, E(X^2) = $\boxed{1.125}$


```{r}
(sum(x * y))^2 
```


In order to calculate E[X(X-1)] we can rewrite this as

E[X^2 - X] = E[X^2] - E[X]

= 1.125 - 0.75 = 0.375

So E[X(X-1)] = $\boxed{0.375}$

for sigma^2 we can plug in the values that we have already calculated

E[X(X-1)] + E[X] - mu^2
=0.375 + .75 - (1.125)^2
= $\boxed{0.5625}$


## #(b)
f(x) =  4! / x!(4 − x)! * (1/2)^4 

```{r}
dbinom(0, 4, 1/2)
```

```{r}
dbinom(1, 4, 1/2)
```

```{r}
dbinom(2, 4, 1/2)
```

```{r}
dbinom(3, 4, 1/2)
```

```{r}
dbinom(4, 4, 1/2)
```

```{r}
#mu =
0 * 0.0625 + 1 *  0.25 + 2 * 0.375 + 3 * 0.25 + 4 * 0.0625
```

E(X(X - 1))
```{r}
0 * (0 - 1) * 0.0625 + 1 * (1 - 1) * 0.25 + 2 * (2-1) * 0.375 + 3 * (3 - 1) * 0.25 + 4 * (4 - 1) * 0.0625
```

sigma^2 =
```{r}
3 + 2 - 2^2
```

Therefore, E(X) = $\boxed{2}$

E(X(X-1)) = $\boxed{3}$

and sigma^2 = $\boxed{1}$

## 2.3-11
If the moment-generating function of X is M(t) = 2/5 * e^t + 1/5 * e^2t + 2/5 * e^3t
find the mean, variance and pmf of X.

E(X) = 
```{r}
1 * 2/5 * exp(0) + 2 *  1/5 * exp(2 *0) + 3 * 2/5 * exp(3 * 0)

```
The mean is E(X) = $\boxed{2}$


E(X^2) =
```{r}
1 * 2/5 * exp(0) + 4 *  1/5 * exp(2 *0) + 9 * 2/5 * exp(3 * 0)

```
The second moment E(X^2) = $\boxed{4.8}$

Var(X) =
```{r}
4.8 - (2)^2
```

The variance is Var(X) = $\boxed{0.8}$

The pmf of the MGF X takes on the values 1,2 and 3, with the corresponding probabilities dervied from the coefficients of the exponents.
The pmf of X is:
P(X = 1) = 2/5, P(X = 2) = 1/5, and P(X = 3) = 2/5.

## 2.3-19

Given a random permutation of the integers in  the set {1, 2, 3, 4, 5}, let X equal the number of integers  that are in their natural position. The moment-generating  function of X is 

M(t) =  44/120 +  45/120 * e^t +  20/120 * e^2t +  10 /120 * e^3t +  1 /120 * e^5t.  

### (a) Find the mean and variance of X. 

M'(t) = 45/120 * e^t +  20/120 * 2e^2t +  10 /120 * 3e^3t +  1 /120 * 5e^5t. 

evaluate M'(t) when t=0


E(X)=
```{r}
45/120 +  40/120 +  30 /120  +  5 /120 
```
The E(X) = 1

M"(t) = 45/120 * e^t +  20/120 * 4e^2t +  10 /120 * 9e^3t +  1 /120 * 25e^5t.

Evaluate M"(t) at t=0


```{r}
45/120 + 80/120 + 90/120 + 25/120
```
The second moment is 5

Calculate the variance
Var(x) = E(X^2) - (E(X)^2)


Var(x)=
```{r}
2-(1)^2
```

Mean E(X) = $\boxed{1}$

Variance Var(X) = $\boxed{1}$

### (b) Find the probability that at least one integer is in its  natural position. 

M(t) =  44/120 +  45/120 * e^t +  20/120 * e^2t +  10 /120 * e^3t +  1 /120 * e^5t.  

f(0) = 44/120

f(1) = 45/120

f(2) = 20/120

f(3) = 10/120

f(5) = 1/120

The complement rule of probability

P(A^c) = 1 - P(A)

P( >= 1) = 1 - P(X = 0)

```{r}
1 - 44/120
```
The probability that at least one integer is in its natural position is $\boxed{0.6333333}$


### (c) M(t) =  44/120 +  45/120 * e^t +  20/120 * e^2t +  10 /120 * e^3t +  1 /120 * e^5t.  

```{r}
X <- c(0, 1, 2, 3, 5)  # Values of X
P_X <- c(44/120, 45/120, 20/120, 10/120, 1/120)  


pmf_table <- data.frame(X, P_X)


print(pmf_table)

```
```{r}
# Load the ggplot2 library
library(ggplot2)

# Create the probability histogram
ggplot(pmf_table, aes(x = factor(X), y = P_X)) +
  geom_bar(stat = "identity", fill = "royalblue") +
  labs(title = "Probability Histogram of X", x = "X", y = "Probability") +
  theme_dark()

```

## 2.4-4
### (a) Let X equal the  number of ducks that are infected.  (a) Assuming independence, how is X distributed? 

1. Let X equal the number of ducks that are infected
2. Number of ducks selected is n = 7
3. Infection rate probability p = 0.15

Thus, X, follows a binomial distribution with n = 7 and p = 0.15

### (b)

P(X=0)
Find (i) P(X ≥ 2), (ii) P(X = 1), and (iii) P(X ≤ 3). 

# f(0) = 7! / 0!(7 − 0)! *(0.15)^0 * (1-0.15)^ 7-0

```{r}
dbinom(0, 7, 0.15)
```

P(X=1)
# f(1) = 7! / 1!(7 − 1)! *(0.15)^1 * (1-0.15)^ 7-1

```{r}
dbinom(1, 7, 0.15)
```

P(X=2)

# f(2) = 7! / 2!(7 − 2)! *(0.15)^2 * (1-0.15)^ 7-2

```{r}
dbinom(2, 7, 0.15)
```

P(X=3)
# f(3) = 7! / 3!(7 − 3)! *(0.15)^3 * (1-0.15)^ 7-3

```{r}
dbinom(3, 7, 0.15)
```

P(X>=x) = 1 - P(X < x)

P(X >=2) = 1 - P(X < 2) = 1 - [P(x=0)+P(x=1)]

We found P(X=0) to be 0.3205771 and P(X=1) to be 0.396007

P(X >=2) =

```{r}
1 - (0.3205771 + 0.396007)
```



P(X=<3)

=P(X=0)+P(X=1)+P(X=2)+P(X=3)

```{r}
0.3205771 + 0.396007 + 0.2096508 + 0.06166199
```

(i) Therefore P(X> = 2) = $\boxed{0.2834159}$
(ii) Therefore P(X = 1) = $\boxed{0.396007}$
(iii) Therefore P(X =< 3) = $\boxed{0.9878969}$


## 2.4-9
### (a) How is X distributed? 

This is a binomial distribution with n = 20 and p = 0.80

### (b) Give the values of the mean, variance, and standard  deviation of X. 

mu = 
```{r}
20 * 0.8
```

variance =
```{r}
20 * 0.8 * (1-0.8)
```

standard deviation =
```{r}
sqrt(3.2)
```

mu = $\boxed{16}$
sigma^2 = $\boxed{3.2}$
sigma = $\boxed{1.788854}$

### (c)
Find (i) P(X = 15), (ii) P(X > 15), and (iii) P(X ≤  15). 

P(X=15) =

# f(15) = 20! / 15!(20 − 15)! *(0.8)^15 * (1-0.8)^ 20-15

```{r}
dbinom(15, 20, 0.8)
```

P(X>15) = P(X=16) + P(X=17) + P(X=18) + P(X=19) + P(X=20)

```{r}
dbinom(16, 20, 0.8)

dbinom(17, 20, 0.8)

dbinom(18, 20, 0.8)

dbinom(19, 20, 0.8)

dbinom(20, 20, 0.8)

```
```{r}
0.2181994 + 0.2053641 + 0.1369094 + 0.05764608 + 0.01152922
```

P(X=<15) = 1 - P(X>15)

```{r}
1 -  0.6296482
```

(i) P(X = 15) = $\boxed{0.1745595}$
(ii) P(X > 15) = $\boxed{0.6296482}$, 
and (iii) P(X ≤  15) = $\boxed{0.3703518}$. 




## 2.5-9
### (a) Exactly one defective item. 

Let X denote the number of defective items in the sample.

```{r}
dhyper(1, 3, 47, 10)
```
 $\boxed{0.3979592}$
 
 
### (b) At most one defective item
```{r}
dhyper(0, 3, 47, 10) + dhyper(1, 3, 47, 10)

```
$\boxed{0.9020408}$


## 2.7-2
Let X have a Poisson distribution with a variance  of 3. Find P(X = 2). 

```{r}
dpois(2, lambda = 3)
```
$\boxed{0.2240418}$


## 2.7-8
### (a) At most one person suffers. 

lambda = n * p
where p = 1000 and n = 0.005

```{r}
(1000 * 0.005)
```

```{r}
ppois(1, lambda = 5)
```
$\boxed{0.04042768}$


### (b)

```{r}
dpois(4, lambda = 5)
dpois(5, lambda = 5)
dpois(6, lambda = 5)
```
```{r}
0.1754674 + 0.1754674 + 0.1462228
```

$\boxed{0.4971576}$

## 2.7-9

(a) What is the expected value of the number sold? 

X ~ Poisson(lambda = 3)
n = 4


```{r}
dpois(0, lambda = 3)
dpois(1, lambda = 3)
dpois(2, lambda = 3)
dpois(3, lambda = 3)
```

```{r}
0.04978707 + 0.1493612 + 0.2240418 + 0.2240418
```

```{r}
1 - 0.6472319
```
P(X>=4) = 0.3527681



E(X) = 
```{r}
(0 * 0.04978707) + (1 * 0.1493612) + (2 * 0.2240418) + (3 * 0.2240418) + ( 4 * 0.3527681)
```

E(X) = $\boxed{2.680643}$

### (b)

```{r}
lambda <- 3  


n <- 3
while (ppois(n, lambda = lambda) <= 0.95) {
  n <- n + 1
}
n

```

He should order $\boxed{6}$ newspapers
